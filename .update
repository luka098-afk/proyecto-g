#!/bin/bash
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸ”„ .update - ActualizaciÃ³n rÃ¡pida del bot
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Colores
G='\033[0;32m'
Y='\033[1;33m'
B='\033[0;34m'
R='\033[0;31m'
NC='\033[0m'

echo -e "${B}ğŸ”„ Actualizando bot...${NC}\n"

# Verificar actualizaciones
git fetch origin main 2>/dev/null || git fetch origin master 2>/dev/null

if [ "$(git rev-parse HEAD)" = "$(git rev-parse @{u})" ]; then
    echo -e "${G}âœ… Ya estÃ¡s actualizado${NC}"
    exit 0
fi

echo -e "${Y}ğŸ“¦ Descargando cambios...${NC}"

# Pull preservando archivos locales
git stash push -m "auto-backup" --quiet 2>/dev/null || true
git pull --strategy-option=ours origin main 2>/dev/null || git pull --strategy-option=ours origin master 2>/dev/null

# Verificar si package.json cambiÃ³
if git diff HEAD@{1} HEAD -- package.json &>/dev/null; then
    echo -e "${Y}ğŸ“¦ Actualizando dependencias...${NC}"
    npm install --quiet
fi

echo -e "${G}âœ… Bot actualizado${NC}"
echo -e "${B}â„¹ï¸  Reinicia: npm start${NC}"
